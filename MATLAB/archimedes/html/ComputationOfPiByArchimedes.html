
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>The Computation of Pi by Archimedes</title><meta name="generator" content="MATLAB 9.0"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2016-01-22"><meta name="DC.source" content="ComputationOfPiByArchimedes.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h1>The Computation of Pi by Archimedes</h1><!--introduction--><p>Copyright 2010, Bill McKeeman, Dartmouth College</p><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#1">Abstract</a></li><li><a href="#4">The General Plan</a></li><li><a href="#5">The Context</a></li><li><a href="#8">The Computation of <img src="ComputationOfPiByArchimedes_eq12719111378361454579.png" alt="$\pi$"></a></li><li><a href="#12">Advice to the Reader</a></li><li><a href="#13">The Outer n-gon</a></li><li><a href="#28">Hand Calculation</a></li><li><a href="#33">MATLAB fractions</a></li><li><a href="#34">Bounds for Irrational Numbers</a></li><li><a href="#37">Square Roots of Rationals</a></li><li><a href="#44">Getting the Continued Fraction</a></li><li><a href="#52">The Upper Bound</a></li><li><a href="#55">Iterating</a></li><li><a href="#61">The Lower Bound</a></li><li><a href="#64">Iterating</a></li><li><a href="#74">QED</a></li><li><a href="#76">Summary</a></li><li><a href="#78">References</a></li></ul></div><h2>Abstract<a name="1"></a></h2><p>It is famously known that Archimedes approximated <img src="ComputationOfPiByArchimedes_eq12719111378361454579.png" alt="$\pi$"> by computing the perimeters of many-edged regular polygons, one polygon inside the circle and one outside.  This presentation recapitulates and explains Archimedes' computation. The surprise to me was how many "tweaks" Archimedes applied at various stages of an otherwise systematic approach.</p><pre class="codeinput">format <span class="string">long</span>
</pre><p><img vspace="5" hspace="5" src="HexPi.jpg" alt=""> </p><h2>The General Plan<a name="4"></a></h2><p>The circumference of a circle of radius <img src="ComputationOfPiByArchimedes_eq03442895190380135198.png" alt="$R$"> is <img src="ComputationOfPiByArchimedes_eq11714737621039935917.png" alt="$2 \pi R$"> which defines <img src="ComputationOfPiByArchimedes_eq12719111378361454579.png" alt="$\pi$">. The perimeter of the inner hexagon is <img src="ComputationOfPiByArchimedes_eq16598591678251820101.png" alt="$6R$"> which implies <img src="ComputationOfPiByArchimedes_eq08799957045284689575.png" alt="$6R < 2 \pi R$">, thus providing a lower bound <img src="ComputationOfPiByArchimedes_eq17998303966223347040.png" alt="$3 < \pi$">. Computing the perimeter of the outer hexagon supplies an upper bound. Increasing the number of edges tightens the bounds.  Thus thought Archimedes.</p><h2>The Context<a name="5"></a></h2><p>The year was earlier than 200 BCE.  Archimedes, who lived in Sicily, knew of the work in Alexandria, where Euclid had published his "Elements" some years before.</p><p>Greek mathematics used a kind of decimal integer.  For example <img src="ComputationOfPiByArchimedes_eq07728673430820969890.png" alt="${_\prime}\alpha\upsilon\kappa\delta{^\prime}$"> means 1424. Mathematicians could express rational numbers, but did not have the concept of the digit 0, the decimal point or the means to represent irrational numbers such as <img src="ComputationOfPiByArchimedes_eq12719111378361454579.png" alt="$\pi$"> and square roots.  Irrational numbers were approximated by rational upper and lower bounds.</p><p>Finally, algebra was unavailable, so words were used to describe computations and algorithms. The flavor of ancient presentation is provided by Archimedes' statement "The surface of any sphere is four times its greatest circle."  We would write <img src="ComputationOfPiByArchimedes_eq14541992301394872778.png" alt="$A = 4 \pi R^2$">.</p><h2>The Computation of <img src="ComputationOfPiByArchimedes_eq12719111378361454579.png" alt="$\pi$"><a name="8"></a></h2><p>The result presented by Archimedes translates to</p><p><img src="ComputationOfPiByArchimedes_eq13936196436013460304.png" alt="$3 \frac{1}{7} &gt; \pi &gt; 3 \frac{10}{71}$"></p><p>which appears, using the numbers of Archimedes' time, as</p><p><img src="ComputationOfPiByArchimedes_eq15351978096541092034.png" alt="$\gamma^{\prime}\;\zeta^{\prime\prime} &gt; \pi &gt; \gamma^{\prime}\;\iota^{\prime}\;o\alpha^{\prime\prime}$"></p><h2>Advice to the Reader<a name="12"></a></h2><p>What follows is a detailed rendition of the steps taken by Archimedes. While following the logic, it may help the reader to look ahead to the Summary to get the big picture of all the computations on one page.</p><h2>The Outer n-gon<a name="13"></a></h2><p><img vspace="5" hspace="5" src="ArchimedesOuter.jpg" alt=""> </p><p>Given the half-edge length <img src="ComputationOfPiByArchimedes_eq11482224311646268393.png" alt="$e_n$"> of any regular n-gon enclosing a circle, one can compute the half-edge length <img src="ComputationOfPiByArchimedes_eq12493057359904884680.png" alt="$e_{2n}$"> of the enclosing regular 2n-gon based on the equations</p><p><img src="ComputationOfPiByArchimedes_eq13429111702423392638.png" alt="$\begin{array}{rcl}    x_n/R       &amp;=&amp; (e_n - e_{2n})/e_{2n}  \\    (x_n+R)/R   &amp;=&amp; e_n/e_{2n}             \\    (x_n+R)/e_n &amp;=&amp; R/e_{2n}               \\    x_n^2       &amp;=&amp; R^2+e_n^2 \end{array}$"></p><p>The first equation is a consequence of similar triangles.  The second and third equations are algebraic manipulations of the first.  The fourth equation is an application of the Pythagorean Theorem.</p><p>The last two equations are combined into an iteration.</p><p><img src="ComputationOfPiByArchimedes_eq11531203865073182307.png" alt="$\begin{array}{rcl}    R/e_{2n} &amp;=&amp; (x_n+R)/e_n                  \\             &amp;=&amp; (R + \sqrt{R^2+e_n^2})/e_n   \\             &amp;=&amp; R/e_n + \sqrt{(R/e_n)^2+1} \end{array}$"></p><p>Let <img src="ComputationOfPiByArchimedes_eq13214019231005417987.png" alt="$a_n \stackrel{\rm def}{=} R/e_n$">. The result is a recursive formula for <img src="ComputationOfPiByArchimedes_eq14777435581760188776.png" alt="$a_{2n}$">.</p><p><img src="ComputationOfPiByArchimedes_eq18190112040535254061.png" alt="$a_{2n} = a_n + \sqrt{a_n^2 + 1}$"></p><p>The value of <img src="ComputationOfPiByArchimedes_eq00752181216644108901.png" alt="$a_n$"> more than doubles at each step, implying that each edge <img src="ComputationOfPiByArchimedes_eq11482224311646268393.png" alt="$e_n$"> is less than one half the length of its predecessor at each step, which is consistent with one's intuitive understanding of the process.</p><p>Archimedes carried out the computation up to the 96-gon, starting with the 30,60,90 degree triangle bounded by sides</p><p><img src="ComputationOfPiByArchimedes_eq07883381491099213100.png" alt="$R, x_6, e_6$"></p><p>which has known dimensions. In MATLAB, for the unit circle,</p><pre class="codeinput">R = 1;
alpha_6 = 2*pi/12;       <span class="comment">% 30 degrees, half angle of the hexagon</span>
x_6 = R/cos(alpha_6);    <span class="comment">% R*sqrt(4/3), hypotenuse</span>
e_6 = x_6*sin(alpha_6);  <span class="comment">% R*sqrt(1/3), half edge of the hexagon</span>
fprintf(<span class="string">'e_6 = %.6g*R = R*sqrt(1/3)\n'</span>, e_6);
</pre><pre class="codeoutput">e_6 = 0.57735*R = R*sqrt(1/3)
</pre><p>Since we know the half-edge <img src="ComputationOfPiByArchimedes_eq07214246962936319836.png" alt="$e_6$"> for <img src="ComputationOfPiByArchimedes_eq10387547836061897444.png" alt="$R=1$">, trying the formula is straightforward.</p><pre class="codeinput">a_6  = R/e_6;
a_12 = a_6  + sqrt(a_6^2  + 1);
a_24 = a_12 + sqrt(a_12^2 + 1);
a_48 = a_24 + sqrt(a_24^2 + 1);
a_96 = a_48 + sqrt(a_48^2 + 1);
e_96 = R/a_96;
</pre><p>The values of <img src="ComputationOfPiByArchimedes_eq00752181216644108901.png" alt="$a_n$"> are more than doubling; the values <img src="ComputationOfPiByArchimedes_eq08751785812583369479.png" alt="$n/a_n$"> are slowly decreasing and converging to <img src="ComputationOfPiByArchimedes_eq12719111378361454579.png" alt="$\pi$"> as expected</p><pre class="codeinput">fprintf(<span class="string">'n     '</span>);
fprintf(<span class="string">'%7d '</span>, 6, 12, 24, 48, 96);
fprintf(<span class="string">'\na_n     '</span>);
fprintf(<span class="string">'%.6g '</span>, a_6, a_12, a_24, a_48, a_96);
fprintf(<span class="string">'\nn/a_n    '</span>);
fprintf(<span class="string">'%.6g '</span>, 6/a_6, 12/a_12, 24/a_24, 48/a_48, 96/a_96);
fprintf(<span class="string">'... %.6g\n'</span>, pi);
</pre><pre class="codeoutput">n           6      12      24      48      96 
a_n     1.73205 3.73205 7.59575 15.2571 30.5468 
n/a_n    3.4641 3.21539 3.15966 3.14609 3.14271 ... 3.14159
</pre><p>Unfortunately for Archimedes, he did not have double precision floating point so he, and therefore we, still have some work to do.</p><h2>Hand Calculation<a name="28"></a></h2><p>It is simpler for hand calculation if the intermediate results are improper fractions with reasonably large integer parts.  This is achieved by multiplying the iteration formula by an arbitrary integer constant <img src="ComputationOfPiByArchimedes_eq08422257486649890878.png" alt="$c$">, the value of which can be chosen later.</p><p><img src="ComputationOfPiByArchimedes_eq01207877650917871644.png" alt="$\begin{array}{rcl}    c R/e_{2n} &amp;=&amp; c (x_n+R)/e_n                  \\             &amp;=&amp; (c R + c \sqrt{R^2+e_n^2})/e_n   \\             &amp;=&amp; c R/e_n + \sqrt{(c R/e_n)^2+c^2} \end{array}$"></p><p>Let <img src="ComputationOfPiByArchimedes_eq01430414299415194690.png" alt="$a_n \stackrel{\rm def}{=} c R/e_n$"> and  <img src="ComputationOfPiByArchimedes_eq11950110146201973964.png" alt="$b_n \stackrel{\rm def}{=} \sqrt{(c R/e_n)^2+c^2}$">. The result is new formulas for <img src="ComputationOfPiByArchimedes_eq09304529305451846291.png" alt="$b_n$"> and <img src="ComputationOfPiByArchimedes_eq14777435581760188776.png" alt="$a_{2n}$">.</p><p><img src="ComputationOfPiByArchimedes_eq00400909328825464926.png" alt="$\begin{array}{rcl}   b_n    &amp;=&amp; \sqrt{a_n^2 + c^2} \\   a_{2n} &amp;=&amp; a_n + b_n  \end{array}$"></p><p>Two mutually recursive formulas are provided because (1) <img src="ComputationOfPiByArchimedes_eq09304529305451846291.png" alt="$b_n$"> is irrational and must be replaced by a rational bound at each step and (2) the edge of the inner n-gon is expressed in terms of <img src="ComputationOfPiByArchimedes_eq09304529305451846291.png" alt="$b_n$">, not <img src="ComputationOfPiByArchimedes_eq00752181216644108901.png" alt="$a_n$">.</p><h2>MATLAB fractions<a name="33"></a></h2><p>This presentation now switches to "Greek mode," that is, variable precision integers (vpi) and fractions (fr), provided by John D'Errico and Ben Petschel on the MathWorks File Exchange.  Except for type conversions putting values into the vpi and fr domains, their packages are non-intrusive in the code that follows. Thank you to MathWorks, John and Ben.</p><h2>Bounds for Irrational Numbers<a name="34"></a></h2><p>Archimedes states without explanation</p><p><img src="ComputationOfPiByArchimedes_eq14737242221898541718.png" alt="$\frac{265}{153} < \sqrt 3 < \frac{1351}{780}$"></p><p>This statement and other similar ones are easily checked without taking square roots in MATLAB (and by Archimedes' readers).</p><pre class="codeinput">assert((265/153)^2 &lt; 3 &amp;&amp; 3 &lt; (1351/780)^2);
</pre><h2>Square Roots of Rationals<a name="37"></a></h2><p>Heath, in his book "The Works of Archimedes," devotes 19 pages to speculations by famous mathematicians on how Archimedes took square roots. At all times Archimedes had to make a tradeoff between the better accuracy of larger denominators against the computational labor involved dealing with larger integers.  The speculation I prefer is that Archimedes used the known iteration for square root with a good starting value to get a very accurate fraction, then picked among the continued fraction convergents to get suitable values of lesser accuracy.</p><p>The following iteration for square root of <img src="ComputationOfPiByArchimedes_eq05508344529756732484.png" alt="$a$">,</p><p><img src="ComputationOfPiByArchimedes_eq07867846351448616557.png" alt="$x \leftarrow \frac{1}{2}(x + a/x)$"></p><p>can be restated for rational radicand <img src="ComputationOfPiByArchimedes_eq00564457484519762187.png" alt="$a/b$"> as</p><p><img src="ComputationOfPiByArchimedes_eq03416747646854629533.png" alt="$\begin{array}{rcl}    x/y &amp;\leftarrow&amp; \frac{1}{2}(x/y+a y/b x) \\    &amp; \leftarrow &amp; (b x^2 + a y^2)/2 b x y \end{array}$"></p><p>It is not hard to pick a good-enough starting point for an improper fraction. If the integer has an odd number of digits and leading digit <img src="ComputationOfPiByArchimedes_eq16171345478199012472.png" alt="$D$">, pick <img src="ComputationOfPiByArchimedes_eq04542539327603317956.png" alt="$S = 1,2\; \mbox{or}\; 3$"> so that <img src="ComputationOfPiByArchimedes_eq11161332512913748751.png" alt="$S^2 <= D$">.  If the integer part has an even number of digits and leading digits <img src="ComputationOfPiByArchimedes_eq17675749837585858341.png" alt="$DE$">, pick <img src="ComputationOfPiByArchimedes_eq10791144664409217828.png" alt="$S = 3,\ldots 9$"> so that <img src="ComputationOfPiByArchimedes_eq14496470268895976419.png" alt="$S^2 <= DE$">.  Then form the initial value <img src="ComputationOfPiByArchimedes_eq12428413953531653171.png" alt="$x$"> by appending to digit <img src="ComputationOfPiByArchimedes_eq14663648698641962978.png" alt="$S$"> a <img src="ComputationOfPiByArchimedes_eq00202142981986870057.png" alt="$0$"> for every pair of unexamined digits.  That is, for <img src="ComputationOfPiByArchimedes_eq15193208805828961691.png" alt="$349450$">, <img src="ComputationOfPiByArchimedes_eq07669260589753856904.png" alt="$DE=34$">, <img src="ComputationOfPiByArchimedes_eq16755005079301354748.png" alt="$S=5$">, <img src="ComputationOfPiByArchimedes_eq02944310283687013601.png" alt="$x=500$">, <img src="ComputationOfPiByArchimedes_eq18200983844500660490.png" alt="$y=1$">.</p><p>Carrying out four steps of the computation for input <img src="ComputationOfPiByArchimedes_eq14956984979706529373.png" alt="$3$"> gives rational approximations for the <img src="ComputationOfPiByArchimedes_eq11724176591115691306.png" alt="$\sqrt 3$">.</p><pre class="codeinput">  n = 4;                   <span class="comment">% the number of steps to take</span>
  a = vpi(3); b = vpi(1);  <span class="comment">% the radicand a/b</span>
  x = 1; y = 1;            <span class="comment">% starting values for the rational result</span>
  <span class="keyword">for</span> i=1:n                <span class="comment">% all values are now vpi</span>
    t = b*x^2 + a*y^2;
    y = 2*b*x*y;
    g = gcd(t,y);          <span class="comment">% known as Euclid's algorithm</span>
    x = t/g;               <span class="comment">% exact division</span>
    y = y/g;
    fprintf(<span class="string">'%.16f  %6d/%d\n'</span>, double([fr(x)/fr(y), x, y]));
  <span class="keyword">end</span>
  fprintf(<span class="string">'...\n%.16f     sqrt(%d/%d)\n'</span>, <span class="keyword">...</span>
    sqrt(double(a/b)), double(a), double(b));
</pre><pre class="codeoutput">2.0000000000000000       2/1
1.7500000000000000       7/4
1.7321428571428572      97/56
1.7320508100147274   18817/10864
...
1.7320508075688772     sqrt(3/1)
</pre><h2>Getting the Continued Fraction<a name="44"></a></h2><p>Taking the most accurate of the four approximations above,</p><pre class="codeinput">  num = vpi(18817);  den = 10864;
  cf = vpi([]);          <span class="comment">% cf coefficients are always integers</span>
  <span class="keyword">while</span> den &gt; 0          <span class="comment">% compute continued fraction</span>
    <span class="keyword">if</span> den == 1          <span class="comment">% choose long form of cf</span>
      <span class="keyword">if</span> num == 1
        r = vpi(1);           <span class="comment">% finish with digit 1</span>
        den = 0;
      <span class="keyword">else</span>               <span class="comment">% force one more digit</span>
        r = num - 1;
        num = 1;
      <span class="keyword">end</span>
    <span class="keyword">else</span>                 <span class="comment">% grab a digit</span>
      r = num/den;       <span class="comment">% integer division</span>
      t = num - r*den;   <span class="comment">% new num/den</span>
      num = den;
      den = t;
    <span class="keyword">end</span>
    cf(end+1) = r;
  <span class="keyword">end</span>
</pre><p>gives the continued fraction for <img src="ComputationOfPiByArchimedes_eq00049178230250113703.png" alt="$\frac{18817}{10864}$">.</p><pre class="codeinput">  fprintf(<span class="string">'%d '</span>, double(cf));
</pre><pre class="codeoutput">1 1 2 1 2 1 2 1 2 1 2 1 2 1 2 1 </pre><p>Evaluating the continued fraction gives a series of convergents, alternating greater or less than the input fraction.  As can be seen in the printout, they are good approximations to <img src="ComputationOfPiByArchimedes_eq11724176591115691306.png" alt="$\sqrt 3$">.</p><pre class="codeinput">   fprintf(<span class="string">'x/y             (x/y)^2+-err\n'</span>);  <span class="comment">% table title</span>
   n = numel(cf);
   <span class="keyword">for</span> i = 1:n                    <span class="comment">% evaluate continued fraction</span>
     <span class="keyword">if</span> i == 1                    <span class="comment">% startup case</span>
       h(i) = cf(i);
       k(i) = 1;
     <span class="keyword">elseif</span> i == 2                <span class="comment">% startup case</span>
       h(i) = cf(i)*h(i-1) + 1;
       k(i) = cf(i)*k(i-1);
     <span class="keyword">elseif</span> i &gt; 2                 <span class="comment">% rest of cf</span>
       h(i) = cf(i)*h(i-1) + h(i-2);
       k(i) = cf(i)*k(i-1) + k(i-2);
     <span class="keyword">end</span>
     <span class="comment">% express result as L+-r/K^2 (need double for fprintf)</span>
     H=double(h(i)); K=double(k(i)); L=round(H^2/K^2); r=H^2-L*K^2;
     conv = [sprintf(<span class="string">'%d/%d'</span>, H, K), <span class="string">'                       '</span>];
     <span class="keyword">if</span> r == 0
       fprintf(<span class="string">'%s %d\n'</span>, conv(1:16), L);
     <span class="keyword">elseif</span> r &lt; 0
       fprintf(<span class="string">'%s %d-%d/%d^2\n'</span>, conv(1:16), L, abs(r), K);
     <span class="keyword">else</span>
       fprintf(<span class="string">'%s %d+%d/%d^2\n'</span>, conv(1:16), L, r, K);
     <span class="keyword">end</span>
   <span class="keyword">end</span>
</pre><pre class="codeoutput">x/y             (x/y)^2+-err
1/1              1
2/1              4
5/3              3-2/3^2
7/4              3+1/4^2
19/11            3-2/11^2
26/15            3+1/15^2
71/41            3-2/41^2
97/56            3+1/56^2
265/153          3-2/153^2
362/209          3+1/209^2
989/571          3-2/571^2
1351/780         3+1/780^2
3691/2131        3-2/2131^2
5042/2911        3+1/2911^2
13775/7953       3-2/7953^2
18817/10864      3+1/10864^2
</pre><p>Perhaps it was from this list that Archimedes chose</p><p><img src="ComputationOfPiByArchimedes_eq00342993254759469482.png" alt="$\frac{1351}{780} &gt; \sqrt 3 &gt; \frac{265}{153}$"></p><p>Since there is not a unique choice, we assume that Archimedes picked values that would lead to the elegant result for <img src="ComputationOfPiByArchimedes_eq12719111378361454579.png" alt="$\pi$">. Mathematicians contemporary to Archimedes mention that later Archimedes did get a more accurate result.</p><p>In any case the objective here is <img src="ComputationOfPiByArchimedes_eq12719111378361454579.png" alt="$\pi$">, not square roots, so from this point on I shall just report the choices Archimedes made for square roots.</p><h2>The Upper Bound<a name="52"></a></h2><p>For the upper bound computation, Archimedes chose the initial values</p><pre class="codeinput">c   = 153;
a_6 = c*R/e_6;       <span class="comment">% 265.0038</span>
b_6 = c*2;           <span class="comment">% which is precise</span>
a_6 = floor(a_6);    <span class="comment">% choose rational lower bound</span>
fprintf(<span class="string">'a_6 = %d, b_6 = %d, c = %d\n'</span>, a_6, b_6, c);
</pre><pre class="codeoutput">a_6 = 265, b_6 = 306, c = 153
</pre><p>There are two values for <img src="ComputationOfPiByArchimedes_eq08083144017497376817.png" alt="$a_6$">.  The first result comes from the geometry of the triangle; the second is a chosen rational approximation.  In this case the chosen <img src="ComputationOfPiByArchimedes_eq08083144017497376817.png" alt="$a_6$"> is just a little low.  Further choices for <img src="ComputationOfPiByArchimedes_eq00752181216644108901.png" alt="$a_n$"> will be consistently low.  The consequence is that rational estimate for <img src="ComputationOfPiByArchimedes_eq13407482223284336879.png" alt="$a_{96}$"> is less than the fully accurate irrational value of <img src="ComputationOfPiByArchimedes_eq13407482223284336879.png" alt="$a_{96}$">. The value of <img src="ComputationOfPiByArchimedes_eq01984386235619380305.png" alt="$e_{96}$"> is therefore greater than the fully accurate half-edge length of the enclosing 96-gon.  Finally <img src="ComputationOfPiByArchimedes_eq10566344474268724727.png" alt="$96\times e_{96}$"> is greater than the half-perimeter of the enclosing 96-gon which is itself greater than <img src="ComputationOfPiByArchimedes_eq12719111378361454579.png" alt="$\pi$">.</p><h2>Iterating<a name="55"></a></h2><p>Following the reasoning above, each time <img src="ComputationOfPiByArchimedes_eq09304529305451846291.png" alt="$b_n$"> is computed, it must be replaced by a rational bound that is smaller than the computed irrational value. The amount of the difference will be small if the values <img src="ComputationOfPiByArchimedes_eq09304529305451846291.png" alt="$b_n$"> are well chosen. Considering Archimedes chose them, we should expect the best.  Nevertheless, we will check. There are three values given by Archimedes for <img src="ComputationOfPiByArchimedes_eq04055821280225069080.png" alt="$b_{12} \ldots b_{48}$">.</p><pre class="codeinput">assert(b_6^2 &lt;= (c*R/e_6)^2 + c^2);
a_12 = a_6 + b_6;    <span class="comment">% 571</span>
</pre><p>Archimedes chose <img src="ComputationOfPiByArchimedes_eq04652461467548840218.png" alt="$\;b_{12} = 591\frac{1}{8}                            < \sqrt{571^2+153^2}                            = \sqrt{349450}                            = 591.143\ldots$"></p><pre class="codeinput">b_12 = fr(591+1/8);   assert(b_12^2 &lt; a_12^2+c^2);
a_24 = a_12 + b_12;  <span class="comment">% 1162 1/8</span>
</pre><pre class="codeoutput">Warning: input value has a remainder mod 1, however function "rat" is not
defined for this object; rounding downwards instead 
</pre><p>Archimedes chose <img src="ComputationOfPiByArchimedes_eq13351328008709890922.png" alt="$b_{24}=1172\frac{1}{8}                            < \sqrt{1162\frac{1}{8}^2+153^2}                            = \sqrt{1373943\frac{33}{64}}                            = 1172.153\ldots$"></p><pre class="codeinput">b_24 = fr(1172+1/8);  assert(b_24^2 &lt; a_24^2+c^2);
a_48 = a_24 + b_24;  <span class="comment">% 2334 1/4</span>
</pre><pre class="codeoutput">Warning: input value has a remainder mod 1, however function "rat" is not
defined for this object; rounding downwards instead 
</pre><p>Archimedes chose <img src="ComputationOfPiByArchimedes_eq08109552778268980533.png" alt="$b_{48}=2339\frac{1}{4}                            < \sqrt{2334\frac{1}{4}^2+153^2}                            = \sqrt{5472132\frac{1}{16}}                            = 2339.259\ldots$"></p><pre class="codeinput">b_48 = fr(2339+1/4);  assert(b_48^2 &lt; a_48^2+c^2);
a_96 = a_48 + b_48;  <span class="comment">% 4673 1/2</span>
</pre><pre class="codeoutput">Warning: input value has a remainder mod 1, however function "rat" is not
defined for this object; rounding downwards instead 
</pre><p>Archimedes made one more approximation, replacing the final (ugly) computed upper bound by one that is less tight but more elegant.</p><pre class="codeinput">pi_hi   = fr(3+1/7)  <span class="comment">% Chosen by Archimedes for publication</span>
pi_est1 = 96*c/a_96  <span class="comment">% Computed by Archimedes</span>
pi                   <span class="comment">% MATLAB's best</span>
</pre><pre class="codeoutput">Warning: input value has a remainder mod 1, however function "rat" is not
defined for this object; rounding downwards instead 

pi_hi =

   3.142857142857143


pi_est1 =

   3.142826575371777


ans =

   3.141592653589793

</pre><p>Using MATLAB, we can check that the values are ordered as expected.</p><pre class="codeinput">assert(pi_hi &gt; pi_est1 &amp;&amp; pi_est1 &gt; pi);
</pre><h2>The Lower Bound<a name="61"></a></h2><p>There is another diagram (in Heath), and another set of geometric equations for the lower bounds which leads to the same recursive formulas. One should not be surprised.  In both cases the n-gons are the same; it is the scale that differs.</p><p>This time the chosen rational values of <img src="ComputationOfPiByArchimedes_eq00752181216644108901.png" alt="$a_n$"> must be greater than the true values, causing the computed half-perimeter <img src="ComputationOfPiByArchimedes_eq10566344474268724727.png" alt="$96\times e_{96}$"> to be less than the actual half-perimeter of the inner 96-gon.</p><p>The initial values are</p><pre class="codeinput">a_6 = 1351; b_6 = 1560; c = 780;   assert(a_6^2+c^2 &gt; b_6^2);
</pre><h2>Iterating<a name="64"></a></h2><p>The values chosen for <img src="ComputationOfPiByArchimedes_eq09304529305451846291.png" alt="$b_n$"> therefore must also be greater than the irrational true values.  Repeating the iteration, and in this case also removing some common factors:</p><pre class="codeinput">a_12 = a_6 + b_6;    <span class="comment">% 2911</span>
</pre><p>Archimedes chose <img src="ComputationOfPiByArchimedes_eq10638473955793101277.png" alt="$b_{12}=3013\frac{3}{4}                            &gt; \sqrt{2911^2+780^2}                            = \sqrt{9082321}                            = 3013.689\ldots$"></p><pre class="codeinput">b_12 = fr(3013+3/4);    assert(b_12^2 &gt; a_12^2+c^2);
a_24 = a_12 + b_12;  <span class="comment">% 5924 3/4</span>
</pre><pre class="codeoutput">Warning: input value has a remainder mod 1, however function "rat" is not
defined for this object; rounding downwards instead 
</pre><p>Archimedes removed the common factor <img src="ComputationOfPiByArchimedes_eq11651646698733657050.png" alt="$\frac{13}{4}$"> from <img src="ComputationOfPiByArchimedes_eq03812191595731393923.png" alt="$a_{24}$"> and <img src="ComputationOfPiByArchimedes_eq08422257486649890878.png" alt="$c$">.</p><pre class="codeinput">a_24 = a_24*(4/13);  <span class="comment">% 1823</span>
c = c*(4/13);        <span class="comment">%  240</span>
</pre><p>Archimedes chose <img src="ComputationOfPiByArchimedes_eq12066877551148086886.png" alt="$b_{24}=1838\frac{9}{11}                            &gt; \sqrt{1823^2+240^2}                            = \sqrt{3380929}                            = 1838.730\ldots$"></p><pre class="codeinput">b_24 = fr(1838+9/11);   assert(b_24^2 &gt; a_24^2+c^2);
a_48 = a_24 + b_24;  <span class="comment">% 3661 9/11</span>
</pre><pre class="codeoutput">Warning: input value has a remainder mod 1, however function "rat" is not
defined for this object; rounding downwards instead 
</pre><p>Archimedes removed the common factor <img src="ComputationOfPiByArchimedes_eq07847938245222882661.png" alt="$\frac{40}{11}$"></p><pre class="codeinput">a_48 = a_48*(11/40); <span class="comment">% 1007</span>
c = c*(11/40);       <span class="comment">%   66</span>
</pre><p>Archimedes chose <img src="ComputationOfPiByArchimedes_eq00099225316844006391.png" alt="$b_{48}=1009\frac{1}{6}                            &gt; \sqrt{1007^2+66^2}                            = \sqrt{1018405}                            = 1009.161\ldots$"></p><pre class="codeinput">b_48 = fr(1009+1/6);    assert(b_48^2 &gt; a_48^2+c^2);
a_96 = a_48 + b_48;  <span class="comment">% 2016 1/6</span>
</pre><pre class="codeoutput">Warning: input value has a remainder mod 1, however function "rat" is not
defined for this object; rounding downwards instead 
</pre><p>Archimedes chose <img src="ComputationOfPiByArchimedes_eq13899888740105308205.png" alt="$b_{96}=2017\frac{1}{4}                            &gt; \sqrt{2016\frac{1}{6}^2+66^2}                            = \sqrt{4069284\frac{1}{36}}                            = 2017.247\ldots$"></p><pre class="codeinput">b_96 = fr(2017+1/4);    assert(b_96^2 &gt; a_96^2+c^2);

pi_lo   = fr(3+10/71);  <span class="comment">% Chosen by Archimedes for publication</span>
pi_est2 = 96*c/b_96;    <span class="comment">% Computed by Archimedes</span>
</pre><pre class="codeoutput">Warning: input value has a remainder mod 1, however function "rat" is not
defined for this object; rounding downwards instead 
Warning: input value has a remainder mod 1, however function "rat" is not
defined for this object; rounding downwards instead 
</pre><p>The five values are</p><pre class="codeinput">disp(pi_hi);
disp(pi_est1);
disp(pi);
disp(pi_est2);
disp(pi_lo);
</pre><pre class="codeoutput">   3.142857142857143

   3.142826575371777

   3.141592653589793

   3.140909654232247

   3.140845070422535

</pre><p>The difference between the published bounds is</p><pre class="codeinput">disp(pi_hi - pi_lo)
</pre><pre class="codeoutput">   0.002012072434608

</pre><p>Check that the five values are in decreasing order</p><pre class="codeinput">assert(pi_lo &lt; pi_est2 &amp;&amp; pi_est2 &lt; pi &amp;&amp; pi &lt; pi_est1 &amp;&amp; pi_est1 &lt; pi_hi);
</pre><h2>QED<a name="74"></a></h2><p>Therefore, <img src="ComputationOfPiByArchimedes_eq16912366776089223445.png" alt="$3\frac{1}{7} &gt; \pi &gt; 3\frac{10}{71}$">.</p><p>Archimedes might have written: <img src="ComputationOfPiByArchimedes_eq12663955922994291964.png" alt="$OE\Delta$"></p><h2>Summary<a name="76"></a></h2><p>Here are all of the intermediate results in a table.  Most of the action is in the choosing of <img src="ComputationOfPiByArchimedes_eq09304529305451846291.png" alt="$b_n$">.  Recall that the chosen values of <img src="ComputationOfPiByArchimedes_eq09304529305451846291.png" alt="$b_n$"> for the outer case must be less than the computed values and conversely greater for the inner case.</p><p><img src="ComputationOfPiByArchimedes_eq04176473854693838108.png" alt="$\begin{array}{lllcllrl}   &amp; \rm outer &amp;&amp;&amp;&amp; \rm inner   &amp;&amp; \rm remark                    \\   a &amp; b &amp; c &amp; \mathbf{n} &amp; a &amp; b &amp; c                            \\   265 &amp; 306 &amp; 153 &amp; \mathbf{6} &amp; 1351 &amp; 1560 &amp; 780 &amp; \rm start  \\   571 &amp; \sqrt{571^2+153^2} &amp; 153 &amp; \mathbf{12}       &amp; 2911 &amp; \sqrt{2911^2+780^2}\makebox[2pt]{} &amp; 780         \\       &amp; 591.1430\ldots &amp;&amp;&amp;&amp; 3013.6889\ldots &amp;&amp; \rm compute      \\       &amp; 591\frac{1}{8} &amp;&amp;&amp;&amp; 3013\frac{3}{4} &amp;&amp; \rm choose       \\       &amp;&amp;&amp; \mathbf{24}       &amp; 5924\frac{3}{4}\makebox[5pt]{} &amp;&amp; 780       &amp; \mbox{factor out}\;\frac{13}{4}                         \\     1162\frac{1}{8} &amp; \sqrt{1162\frac{1}{8}^2+153^2} &amp; 153 &amp;    &amp; 1823 &amp; \sqrt{1823^2+240^2} &amp; 240                           \\    &amp; 1172.1534\ldots &amp;&amp;&amp;&amp; 1838.7303\ldots  &amp;&amp; \rm compute       \\    &amp; 1172\frac{1}{8} &amp;&amp;&amp;&amp; 1838\frac{9}{11} &amp;&amp; \rm choose \end{array}$"></p><p><img src="ComputationOfPiByArchimedes_eq05819362629336590668.png" alt="$\begin{array}{lllcllrl}  &amp;&amp; &amp; \mathbf{48}    &amp; 3661\frac{9}{11} &amp;&amp; 240 &amp; \mbox{factor out}\;\frac{40}{11} \\    2334\frac{1}{4} &amp; \sqrt{2334\frac{1}{4}^2+153^2} &amp; 153    &amp;&amp; 1007 &amp; \sqrt{1007^2+66^2} &amp; 66                            \\    &amp; 2339.2589\ldots &amp;&amp;&amp;&amp; 1009.1605\ldots &amp;&amp; \rm compute        \\    &amp; 2339\frac{1}{4} &amp;&amp;&amp;&amp; 1009\frac{1}{6} &amp;&amp; \rm choose         \\   4673\frac{1}{2} &amp; (b\;\mbox{not needed}) &amp; 153 &amp; \mathbf{96}     &amp; 2016\frac{1}{6} &amp; \sqrt{2016\frac{1}{6}^2+66^2} &amp; 66      \\     &amp;&amp;&amp;&amp;&amp; 2017.2467\ldots &amp;&amp; \rm compute                        \\     &amp;&amp;&amp;&amp;&amp; 2017\frac{1}{4} &amp;&amp;  \rm choose \end{array}$"></p><p><img src="ComputationOfPiByArchimedes_eq07368756300055919426.png" alt="$\begin{array}{cc}   \rm outer\;result &amp; \rm inner\;result                          \\   96\times 153/ 4673\frac{1}{2}=3\frac{1335}{9347}=3.1428265982\ldots &amp;   96\times 66 / 2017\frac{1}{4}=3 \frac{1137}{8069}=3.1409096542\ldots \end{array}$"></p><h2>References<a name="78"></a></h2><p>My principal references are "The Works of Archimedes" (1897), "The Method of Archimedes Recently Discovered by Heiberg" (1912) and "A History of Greek Mathematics" (1921) all by Sir Thomas Heath.  The 1921 book is still in print; Dartmouth Library dug wonderful dusty old tomes from storage for the rest.  I also watched an enjoyable lecture on Archimedes in "Great Thinkers, Great Theorems" by Professor William Dunham (Great Courses series) and read some entries in Wikipedia.</p><p class="footer"><br><a href="http://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2016b</a><br></p></div><!--
##### SOURCE BEGIN #####
%% The Computation of Pi by Archimedes
% Copyright 2010, Bill McKeeman, Dartmouth College
%% Abstract
% It is famously known that Archimedes approximated $\pi$ by computing the
% perimeters of many-edged regular polygons, one polygon inside the circle
% and one outside.  This presentation recapitulates and explains
% Archimedes' computation. The surprise to me was how many "tweaks"
% Archimedes applied at various stages of an otherwise systematic
% approach.  
%%
format long
%% 
% <<HexPi.jpg>> 
%% The General Plan
% The circumference of a circle of radius $R$ is $2 \pi R$ which defines
% $\pi$. The perimeter of the inner hexagon is $6R$ which implies $6R < 2
% \pi R$, thus providing a lower bound $3 < \pi$. Computing the perimeter
% of the outer hexagon supplies an upper bound. Increasing the number of
% edges tightens the bounds.  Thus thought Archimedes.  
%% The Context
% The year was earlier than 200 BCE.  Archimedes, who lived in Sicily, knew
% of the work in Alexandria, where Euclid had published his "Elements" some
% years before.
%%
% Greek mathematics used a kind of decimal integer.  For example
% ${_\prime}\alpha\upsilon\kappa\delta{^\prime}$ means 1424. Mathematicians
% could express rational numbers, but did not have the concept of the digit
% 0, the decimal point or the means to represent irrational numbers such as
% $\pi$ and square roots.  Irrational numbers were approximated by rational
% upper and lower bounds.
%%
% Finally, algebra was unavailable, so words were used to describe
% computations and algorithms. The flavor of ancient presentation is
% provided by Archimedes' statement "The surface of any sphere is four
% times its greatest circle."  We would write $A = 4 \pi R^2$.
%
%% The Computation of $\pi$
% The result presented by Archimedes translates to
%%
% $3 \frac{1}{7} > \pi > 3 \frac{10}{71}$
%% 
% which appears, using the numbers of Archimedes' time, as
%%
% $\gamma^{\prime}\;\zeta^{\prime\prime} > \pi >
% \gamma^{\prime}\;\iota^{\prime}\;o\alpha^{\prime\prime}$ 
%% Advice to the Reader
% What follows is a detailed rendition of the steps taken by Archimedes.
% While following the logic, it may help the reader to look ahead to the
% Summary to get the big picture of all the computations on one page.
%% The Outer n-gon
% 
% <<ArchimedesOuter.jpg>>
%%
% Given the half-edge length $e_n$ of any regular n-gon enclosing a circle,
% one can compute the half-edge length $e_{2n}$ of the enclosing regular
% 2n-gon based on the equations 
%%
% $\begin{array}{rcl}
%    x_n/R       &=& (e_n - e_{2n})/e_{2n}  \\
%    (x_n+R)/R   &=& e_n/e_{2n}             \\
%    (x_n+R)/e_n &=& R/e_{2n}               \\
%    x_n^2       &=& R^2+e_n^2
% \end{array}$
%%
% The first equation is a consequence of similar triangles.  The second and
% third equations are algebraic manipulations of the first.  The fourth
% equation is an application of the Pythagorean Theorem.
%%
% The last two equations are combined into an iteration.
%%
% $\begin{array}{rcl}
%    R/e_{2n} &=& (x_n+R)/e_n                  \\
%             &=& (R + \sqrt{R^2+e_n^2})/e_n   \\
%             &=& R/e_n + \sqrt{(R/e_n)^2+1}  
% \end{array}$
%% 
% Let $a_n \stackrel{\rm def}{=} R/e_n$.
% The result is a recursive formula for $a_{2n}$.
%%
% $a_{2n} = a_n + \sqrt{a_n^2 + 1}$
%%
% The value of $a_n$ more than doubles at each step, implying that each
% edge $e_n$ is less than one half the length of its predecessor at each
% step, which is consistent with one's intuitive understanding of the
% process.
%%
% Archimedes carried out the computation up to the 96-gon, starting with
% the 30,60,90 degree triangle bounded by sides 
%%
% $R, x_6, e_6$ 
%%
% which has known dimensions. In MATLAB, for the unit circle,
R = 1;
alpha_6 = 2*pi/12;       % 30 degrees, half angle of the hexagon
x_6 = R/cos(alpha_6);    % R*sqrt(4/3), hypotenuse
e_6 = x_6*sin(alpha_6);  % R*sqrt(1/3), half edge of the hexagon
fprintf('e_6 = %.6g*R = R*sqrt(1/3)\n', e_6);
%%
% Since we know the half-edge $e_6$ for $R=1$, trying the formula is
% straightforward.
a_6  = R/e_6;
a_12 = a_6  + sqrt(a_6^2  + 1);
a_24 = a_12 + sqrt(a_12^2 + 1);
a_48 = a_24 + sqrt(a_24^2 + 1);
a_96 = a_48 + sqrt(a_48^2 + 1);
e_96 = R/a_96;
%%
% The values of $a_n$ are more than doubling; the values $n/a_n$ are slowly
% decreasing and converging to $\pi$ as expected
fprintf('n     ');
fprintf('%7d ', 6, 12, 24, 48, 96);
fprintf('\na_n     ');
fprintf('%.6g ', a_6, a_12, a_24, a_48, a_96);
fprintf('\nn/a_n    ');
fprintf('%.6g ', 6/a_6, 12/a_12, 24/a_24, 48/a_48, 96/a_96);
fprintf('... %.6g\n', pi);
%%
% Unfortunately for Archimedes, he did not have double precision floating
% point so he, and therefore we, still have some work to do.  
%% Hand Calculation
% It is simpler for hand calculation if the intermediate results are
% improper fractions with reasonably large integer parts.  This is achieved
% by multiplying the iteration formula by an arbitrary integer constant
% $c$, the value of which can be chosen later. 
%%
% $\begin{array}{rcl}
%    c R/e_{2n} &=& c (x_n+R)/e_n                  \\
%             &=& (c R + c \sqrt{R^2+e_n^2})/e_n   \\
%             &=& c R/e_n + \sqrt{(c R/e_n)^2+c^2}  
% \end{array}$
%% 
% Let $a_n \stackrel{\rm def}{=} c R/e_n$ and 
%  $b_n \stackrel{\rm def}{=} \sqrt{(c R/e_n)^2+c^2}$.
% The result is new formulas for $b_n$ and $a_{2n}$.
%%
% $\begin{array}{rcl}
%   b_n    &=& \sqrt{a_n^2 + c^2} \\
%   a_{2n} &=& a_n + b_n
%  \end{array}$
%%
% Two mutually recursive formulas are provided because (1) $b_n$ is
% irrational and must be replaced by a rational bound at each step and (2)
% the edge of the inner n-gon is expressed in terms of $b_n$, not $a_n$.
%% MATLAB fractions
% This presentation now switches to "Greek mode," that is, variable
% precision integers (vpi) and fractions (fr), provided by John D'Errico
% and Ben Petschel on the MathWorks File Exchange.  Except for type
% conversions putting values into the vpi and fr domains, their packages
% are non-intrusive in the code that follows. Thank you to MathWorks, John
% and Ben.
%% Bounds for Irrational Numbers
% Archimedes states without explanation
%%
% $\frac{265}{153} < \sqrt 3 < \frac{1351}{780}$
%%
% This statement and other similar ones are easily checked without taking
% square roots in MATLAB (and by Archimedes' readers).
assert((265/153)^2 < 3 && 3 < (1351/780)^2);  
%% Square Roots of Rationals
% Heath, in his book "The Works of Archimedes," devotes 19 pages to
% speculations by famous mathematicians on how Archimedes took square
% roots. At all times Archimedes had to make a tradeoff between the better
% accuracy of larger denominators against the computational labor involved
% dealing with larger integers.  The speculation I prefer is that
% Archimedes used the known iteration for square root with a good starting
% value to get a very accurate fraction, then picked among the continued
% fraction convergents to get suitable values of lesser accuracy. 
%% 
% The following iteration for square root of $a$, 
%%
% $x \leftarrow \frac{1}{2}(x + a/x)$
%%
% can be restated for rational radicand $a/b$ as
%%
% $\begin{array}{rcl}
%    x/y &\leftarrow& \frac{1}{2}(x/y+a y/b x) \\
%    & \leftarrow & (b x^2 + a y^2)/2 b x y
% \end{array}$
%%
% It is not hard to pick a good-enough starting point for an improper
% fraction. If the integer has an odd number of digits and leading digit
% $D$, pick $S = 1,2\; \mbox{or}\; 3$ so that $S^2 <= D$.  If the integer
% part has an even number of digits and leading digits $DE$, pick $S =
% 3,\ldots 9$ so that $S^2 <= DE$.  Then form the initial value $x$ by
% appending to digit $S$ a $0$ for every pair of unexamined digits.  That
% is, for $349450$, $DE=34$, $S=5$, $x=500$, $y=1$. 
%%
% Carrying out four steps of the computation for input $3$ gives rational
% approximations for the $\sqrt 3$.
  n = 4;                   % the number of steps to take
  a = vpi(3); b = vpi(1);  % the radicand a/b
  x = 1; y = 1;            % starting values for the rational result
  for i=1:n                % all values are now vpi
    t = b*x^2 + a*y^2;
    y = 2*b*x*y;
    g = gcd(t,y);          % known as Euclid's algorithm
    x = t/g;               % exact division
    y = y/g;
    fprintf('%.16f  %6d/%d\n', double([fr(x)/fr(y), x, y]));
  end
  fprintf('...\n%.16f     sqrt(%d/%d)\n', ...
    sqrt(double(a/b)), double(a), double(b));
%% Getting the Continued Fraction
% Taking the most accurate of the four approximations above,
  num = vpi(18817);  den = 10864;
  cf = vpi([]);          % cf coefficients are always integers
  while den > 0          % compute continued fraction
    if den == 1          % choose long form of cf
      if num == 1
        r = vpi(1);           % finish with digit 1
        den = 0;
      else               % force one more digit
        r = num - 1;
        num = 1;
      end
    else                 % grab a digit
      r = num/den;       % integer division
      t = num - r*den;   % new num/den
      num = den;
      den = t;
    end
    cf(end+1) = r;
  end
 %%
 % gives the continued fraction for $\frac{18817}{10864}$.
  fprintf('%d ', double(cf));
%%
% Evaluating the continued fraction gives a series of convergents,
% alternating greater or less than the input fraction.  As can be seen in
% the printout, they are good approximations to $\sqrt 3$.
%%
   fprintf('x/y             (x/y)^2+-err\n');  % table title
   n = numel(cf);
   for i = 1:n                    % evaluate continued fraction
     if i == 1                    % startup case
       h(i) = cf(i);
       k(i) = 1;
     elseif i == 2                % startup case
       h(i) = cf(i)*h(i-1) + 1;
       k(i) = cf(i)*k(i-1);
     elseif i > 2                 % rest of cf
       h(i) = cf(i)*h(i-1) + h(i-2);
       k(i) = cf(i)*k(i-1) + k(i-2);
     end
     % express result as L+-r/K^2 (need double for fprintf)
     H=double(h(i)); K=double(k(i)); L=round(H^2/K^2); r=H^2-L*K^2;
     conv = [sprintf('%d/%d', H, K), '                       '];
     if r == 0
       fprintf('%s %d\n', conv(1:16), L);
     elseif r < 0
       fprintf('%s %d-%d/%d^2\n', conv(1:16), L, abs(r), K);
     else
       fprintf('%s %d+%d/%d^2\n', conv(1:16), L, r, K);
     end
   end

%%
% Perhaps it was from this list that Archimedes chose
%%
% $\frac{1351}{780} > \sqrt 3 > \frac{265}{153}$
%%
% Since there is not a unique choice, we assume that Archimedes picked
% values that would lead to the elegant result for $\pi$. Mathematicians
% contemporary to Archimedes mention that later Archimedes did get a more
% accurate result.
%%
% In any case the objective here is $\pi$, not square roots, so from this
% point on I shall just report the choices Archimedes made for square
% roots.
%% The Upper Bound
%% 
% For the upper bound computation, Archimedes chose the initial values
c   = 153;
a_6 = c*R/e_6;       % 265.0038
b_6 = c*2;           % which is precise
a_6 = floor(a_6);    % choose rational lower bound
fprintf('a_6 = %d, b_6 = %d, c = %d\n', a_6, b_6, c);
%%
% There are two values for $a_6$.  The first result comes from the geometry
% of the triangle; the second is a chosen rational approximation.  In this
% case the chosen $a_6$ is just a little low.  Further choices for $a_n$
% will be consistently low.  The consequence is that rational estimate for
% $a_{96}$ is less than the fully accurate irrational value of $a_{96}$.
% The value of $e_{96}$ is therefore greater than the fully accurate
% half-edge length of the enclosing 96-gon.  Finally $96\times e_{96}$ is
% greater than the half-perimeter of the enclosing 96-gon which is itself
% greater than $\pi$.
%% Iterating
% Following the reasoning above, each time $b_n$ is computed, it must be
% replaced by a rational bound that is smaller than the computed irrational
% value. The amount of the difference will be small if the values $b_n$ are
% well chosen. Considering Archimedes chose them, we should expect the
% best.  Nevertheless, we will check. There are three values given by
% Archimedes for $b_{12} \ldots b_{48}$. 
assert(b_6^2 <= (c*R/e_6)^2 + c^2);
a_12 = a_6 + b_6;    % 571
%%
% Archimedes chose $\;b_{12} = 591\frac{1}{8} 
%                            < \sqrt{571^2+153^2} 
%                            = \sqrt{349450} 
%                            = 591.143\ldots$
b_12 = fr(591+1/8);   assert(b_12^2 < a_12^2+c^2);
a_24 = a_12 + b_12;  % 1162 1/8
%%
% Archimedes chose $b_{24}=1172\frac{1}{8}
%                            < \sqrt{1162\frac{1}{8}^2+153^2} 
%                            = \sqrt{1373943\frac{33}{64}} 
%                            = 1172.153\ldots$
b_24 = fr(1172+1/8);  assert(b_24^2 < a_24^2+c^2);
a_48 = a_24 + b_24;  % 2334 1/4
%% 
% Archimedes chose $b_{48}=2339\frac{1}{4}
%                            < \sqrt{2334\frac{1}{4}^2+153^2} 
%                            = \sqrt{5472132\frac{1}{16}} 
%                            = 2339.259\ldots$
b_48 = fr(2339+1/4);  assert(b_48^2 < a_48^2+c^2);
a_96 = a_48 + b_48;  % 4673 1/2
%% 
% Archimedes made one more approximation, replacing the final (ugly)
% computed upper bound by one that is less tight but more elegant.  
pi_hi   = fr(3+1/7)  % Chosen by Archimedes for publication
pi_est1 = 96*c/a_96  % Computed by Archimedes
pi                   % MATLAB's best
%%
% Using MATLAB, we can check that the values are ordered as expected.
assert(pi_hi > pi_est1 && pi_est1 > pi);
%% The Lower Bound
% There is another diagram (in Heath), and another set of geometric
% equations for the lower bounds which leads to the same recursive
% formulas. One should not be surprised.  In both cases the n-gons are the
% same; it is the scale that differs. 
%%
% This time the chosen rational values of $a_n$ must be greater than the
% true values, causing the computed half-perimeter $96\times e_{96}$ to be
% less than the actual half-perimeter of the inner 96-gon. 
%%
% The initial values are
a_6 = 1351; b_6 = 1560; c = 780;   assert(a_6^2+c^2 > b_6^2);
%% Iterating
% The values chosen for $b_n$ therefore must also be greater than the
% irrational true values.  Repeating the iteration, and in this case also
% removing some common factors:
a_12 = a_6 + b_6;    % 2911
%%
% Archimedes chose $b_{12}=3013\frac{3}{4}
%                            > \sqrt{2911^2+780^2} 
%                            = \sqrt{9082321} 
%                            = 3013.689\ldots$
b_12 = fr(3013+3/4);    assert(b_12^2 > a_12^2+c^2);
a_24 = a_12 + b_12;  % 5924 3/4
%%
% Archimedes removed the common factor $\frac{13}{4}$ from $a_{24}$ and
% $c$.
a_24 = a_24*(4/13);  % 1823
c = c*(4/13);        %  240
%%
% Archimedes chose $b_{24}=1838\frac{9}{11}
%                            > \sqrt{1823^2+240^2} 
%                            = \sqrt{3380929} 
%                            = 1838.730\ldots$
b_24 = fr(1838+9/11);   assert(b_24^2 > a_24^2+c^2);
a_48 = a_24 + b_24;  % 3661 9/11
%%
% Archimedes removed the common factor $\frac{40}{11}$
a_48 = a_48*(11/40); % 1007
c = c*(11/40);       %   66
%% 
% Archimedes chose $b_{48}=1009\frac{1}{6}
%                            > \sqrt{1007^2+66^2} 
%                            = \sqrt{1018405} 
%                            = 1009.161\ldots$
b_48 = fr(1009+1/6);    assert(b_48^2 > a_48^2+c^2);
a_96 = a_48 + b_48;  % 2016 1/6
%%
% Archimedes chose $b_{96}=2017\frac{1}{4}
%                            > \sqrt{2016\frac{1}{6}^2+66^2} 
%                            = \sqrt{4069284\frac{1}{36}} 
%                            = 2017.247\ldots$
b_96 = fr(2017+1/4);    assert(b_96^2 > a_96^2+c^2);

pi_lo   = fr(3+10/71);  % Chosen by Archimedes for publication
pi_est2 = 96*c/b_96;    % Computed by Archimedes
%%
% The five values are
disp(pi_hi);
disp(pi_est1);
disp(pi);
disp(pi_est2);
disp(pi_lo);
%%
% The difference between the published bounds is
disp(pi_hi - pi_lo)
%%
% Check that the five values are in decreasing order
assert(pi_lo < pi_est2 && pi_est2 < pi && pi < pi_est1 && pi_est1 < pi_hi);
%% QED
% Therefore, $3\frac{1}{7} > \pi > 3\frac{10}{71}$.
%%
% Archimedes might have written: $OE\Delta$
%% Summary
% Here are all of the intermediate results in a table.  Most of the action
% is in the choosing of $b_n$.  Recall that the chosen values of $b_n$ for
% the outer case must be less than the computed values and conversely
% greater for the inner case.
%%
% $\begin{array}{lllcllrl}
%   & \rm outer &&&& \rm inner   && \rm remark                    \\
%   a & b & c & \mathbf{n} & a & b & c                            \\
%   265 & 306 & 153 & \mathbf{6} & 1351 & 1560 & 780 & \rm start  \\
%   571 & \sqrt{571^2+153^2} & 153 & \mathbf{12} 
%       & 2911 & \sqrt{2911^2+780^2}\makebox[2pt]{} & 780         \\
%       & 591.1430\ldots &&&& 3013.6889\ldots && \rm compute      \\
%       & 591\frac{1}{8} &&&& 3013\frac{3}{4} && \rm choose       \\
%       &&& \mathbf{24}
%       & 5924\frac{3}{4}\makebox[5pt]{} && 780 
%       & \mbox{factor out}\;\frac{13}{4}                         \\
%     1162\frac{1}{8} & \sqrt{1162\frac{1}{8}^2+153^2} & 153 &
%    & 1823 & \sqrt{1823^2+240^2} & 240                           \\
%    & 1172.1534\ldots &&&& 1838.7303\ldots  && \rm compute       \\
%    & 1172\frac{1}{8} &&&& 1838\frac{9}{11} && \rm choose
% \end{array}$
%
% $\begin{array}{lllcllrl}
%  && & \mathbf{48}
%    & 3661\frac{9}{11} && 240 & \mbox{factor out}\;\frac{40}{11} \\
%    2334\frac{1}{4} & \sqrt{2334\frac{1}{4}^2+153^2} & 153 
%    && 1007 & \sqrt{1007^2+66^2} & 66                            \\
%    & 2339.2589\ldots &&&& 1009.1605\ldots && \rm compute        \\
%    & 2339\frac{1}{4} &&&& 1009\frac{1}{6} && \rm choose         \\
%   4673\frac{1}{2} & (b\;\mbox{not needed}) & 153 & \mathbf{96} 
%     & 2016\frac{1}{6} & \sqrt{2016\frac{1}{6}^2+66^2} & 66      \\
%     &&&&& 2017.2467\ldots && \rm compute                        \\
%     &&&&& 2017\frac{1}{4} &&  \rm choose
% \end{array}$
%
% $\begin{array}{cc}
%   \rm outer\;result & \rm inner\;result                          \\
%   96\times 153/ 4673\frac{1}{2}=3\frac{1335}{9347}=3.1428265982\ldots &  
%   96\times 66 / 2017\frac{1}{4}=3 \frac{1137}{8069}=3.1409096542\ldots                       
% \end{array}$
%% References
% My principal references are "The Works of Archimedes" (1897), "The Method
% of Archimedes Recently Discovered by Heiberg" (1912) and "A History of
% Greek Mathematics" (1921) all by Sir Thomas Heath.  The 1921 book is
% still in print; Dartmouth Library dug wonderful dusty old tomes from
% storage for the rest.  I also watched an enjoyable lecture on Archimedes
% in "Great Thinkers, Great Theorems" by Professor William Dunham (Great
% Courses series) and read some entries in Wikipedia.


##### SOURCE END #####
--></body></html>